VB6 Tutorial 15: Data Type Conversions

<p>You have already learned about various data types in this tutorial site. Now I’m going to explore the concept of data type conversion also known as type casting.</p>

<h3>What is data type conversion?</h3>
<p>When you’re working with many variables of different data types in an expression, the variable or expression on the right hand side of the assignment operator must first be converted into the target type, otherwise assignment will not be possible.</p>
<p>In some cases, Visual Basic does it for you. That means that you don’t need to write code to convert the data types; conversion is done automatically. But this doesn’t happen all the time, so you need to learn how to convert them.</p>
<h3>Implicit data type conversion</h3>
<p>In many cases, Visual Basic does the conversion job automatically. For example, when a numeric value is assigned to a String variable, the type casting is done automatically.</p>
<p>In the following example, Visual Basic implicitly converts the value of number to string before assigning to msg.</p>
<h4>Example</h4>
<p><pre>Dim number As Integer, msg As String
number = 44545
msg = number
Print msg</pre></p>
<p>Visual Basic converts the types wherever it can, and you have to convert the values into appropriate type in other cases. </p>
<h3>Explicit conversion</h3>
<p>In many cases you have to explicitly convert the data values to another data type. Visual Basic has provided so many useful conversion functions.</p>
<h4>Example</h4>
<p>Works without the CInt function also.</p>
<p><pre>Dim n As Integer, d As Double
d = 5.6767
n = CInt(d)
Print n</pre></p>
<p>Output: 6 </p>
<h3>Conversion functions</h3>
<p>The functions are CBool, CByte, CCur, CDate, CDbl, CDec, CInt, CLng, CSng, CStr, and CVar.</p>
<p>Val and Str functions are also used. </p>
<p>Press F2 and type in the search box “Conversion”, then you’ll see all the functions with details under the Conversion module. All the data type conversion functions are explained below.</p>
<div class="info">
<h3>Quickhint:</h3>
<p>The argument of such function must be within the range of that particular data type, into which the value is converted.</p>
</div>
<h4>CStr</h4>
<p>The Cstr function converts an expression to a string. This is useful when you’re displaying some numeric values in a text box control.</p>
<h5>Example</h5>
<p><pre>Dim v1 As Double
Text1.Text = CStr(v1)</pre></p>
<h4>Str<h4>
<p>The Str function converts a number to a string. It is similar to the Cstr function.</p>
<h5>Example</h5>
<p><pre>Dim str1 As String, m As Integer
str1 = Str(m)</pre></p>
<p>While programming you’ll need the string representation of a number so many times.</p>
<h4>CDbl</h4>
<p>The CDbl function converts an expression into a Double. It also extracts the numeric value from a string.</p>
<h5>Example</h5> 
<p>If you omit the CDbl function, the program will raise an overflow error.</p>
<p><pre>Dim m As Integer, v As Double
m = 30887
v = CDbl(m) * 31880
Print v</pre></p>
<h5>Example</h5>
<p><pre>Dim value As Double
value = CDbl(Text1.Text)
Print value + 1</pre></p>
<h5>Example</h5>
<p><pre>Dim value As Double
value = CDbl("55")
Print value + 1</pre></p>
<h4>Val</h4>
<p>Sometimes you can use the Val function instead of the CDbl function.  Val function returns a Double value. It only returns the numeric value contained in a string. Unlike the CDbl function, it cannot convert a numeric expression.</p>
<h5>Example</h5>
<p><pre>Dim l As Double 
l = Val(Text1.Text)</pre></p>
<h4>CInt</h4>
<p>The CInt function converts a number to integer. </p>
<h5>Example</h5>
<p><pre>Dim m As Integer
m = CInt(876.878)   'Returns 877 after roundin the no.
m = CInt(-2.7)   'Returns -3 after rounding the no.</pre></p>
<p>The argument must be within the Integer range here.</p>
<p>876.878 and -2.7 are the arguments in the above code. </p>
<h4>CLng</h4>
<p>The CLng function converts to Long type. </p>
<h5>Example</h5>
<p><pre>Dim ln As Long
ln = CLng(1147483647.87656) 'Rounds up the value
Debug.Print ln</pre></p>
<h4>CBool</h4>
<p>The CBool function converts an expression to Boolean Data type, i.e either True or False.</p>
<p>The value of zero is converted to False and all other numeric values are converted to True. The strings “True” and “False” return True and False Boolean values respectively.</p>
<h5>Example</h5> 
<p><pre>Dim B as Boolean
B=cbool(0)       'Returns False
B=cbool(1)       'Returns true
B=cbool(345)     'Returns True</pre></p>
<p>CByte, CSng, CVar,CCur,CDate and CDecimal functions convert to Byte, Sinle, Variant, Currency, Date and Decimal values respectively. You can use these functions in the same way explained above.</p>