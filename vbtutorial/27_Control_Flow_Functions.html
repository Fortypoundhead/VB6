VB6 Tutorial 27: Other Control Flow Functions


<p>This section discusses the control flow functions such as IIf, Choose and Switch functions. </p>

<p>You can choose to use these VBA control flow functions instead of always using the common control flow statements or control flow blocks like If-Else or Select Case.</p>
<p>See the following lessons for If-Else and Select Case statements:</p>
<ul><li><a href="https://www.fortypoundhead.com/showcontent.asp?artid=24245" target="_blank">Lesson 17: If-blocks</a></li>
<li><a href="https://www.fortypoundhead.com/showcontent.asp?artid=24247" target="_blank">Lesson 18: Nested If-Else</a></li>
<li><a href="https://www.fortypoundhead.com/showcontent.asp?artid=24248" target="_blank">Lesson 19: Select Case blocks</a></li></ul>
<p>Why to use control flow functions instead of the control flow blocks?</p>
<p>The IIf, Choose and Switch control flow functions reduce the amount of code you have to write. In many cases, just one line of code does your work, while the If or Select Case control flow blocks takes more lines.</p>
<h3>The IIF function</h3>
<p>You can use the IIf function instead of the If-Else statements. </p>
<p>Remember that the IIF function can never be the substitute for all the conditional If-Else problems. In fact, the If-blocks are very powerful in the sense that they can solve many complex problems. All the same the IIf function is useful especially when the problem is small.</p>
<h4>Syntax</h4>
<p><pre>Value = IIf(Condition, True Part, False Part)</pre></p>
<h4>Example of IIF</h4>
<p><pre>str = IIf(n > 0, "Greater than zero", "Less than Zero")</pre></p>
<h4>Equivalent code</h4>
<p><pre>If n > 0 Then
    str = "Greater than Zero"
Else
    str = "Less than zero"
End If</pre></p>
<p>So now this is clear that the IIf function does the same job of an If-Else block having five lines with just one line of code.</p>
<h3>The Choose function</h3>
<p>The choose function selects and returns a value from a list of arguments.</p>
<h4>Example</h4>
<p><pre>m = Choose(2, "White", "Green", "Yello")</pre></p>
<p>The index determines which argument value to be returned. Here the index is 2, so the string value "Green" is returned and assigned to m.</p>
<h3>The Switch function</h3>
<p>You can get the same effect of a Select Case block using the Switch function with just one line of code.</p>
<h4>Example</h4>
<p><pre>size = Switch(num <= 9, 1, num <= 99, 2, num <= 999, 3)</pre></p>
<h4>Equivalent code</h4>
<p><pre>Select Case num
    Case Is <= 9
        size = 1
    Case 10 To 99
        size = 2
    Case 100 To 999
        size = 3
End Select</pre></p>
<p>So the same result is achieved using the Switch function. But the Switch function evaluates all the expressions, even though only one is True, and that slows down the process.</p>
<h4>Select Case block with Else</h4>
<p><pre>Select Case Color
    Case vbRed
        str = "Red"
    Case vbBlue
        str = "Blue"
    Case vbBlack
        str = "Black"
    Case Else
        str = "Other"
End Select</pre></p>
<h4>Equivalent code</h4>
<p><pre>str = Switch(Color = vbRed, "Red", Color = vbBlue, "Blue", Color = vbBlack, "Black", True, "Other")</pre></p>
<p>Here the True argument indicates the else part.</p>
<h3>Drawbacks</h3>
<p>The control flow functions IIf, Switch and Choose are always slower than the If or Select Case structure and this is a big disadvantage of them. So always be aware that though these functions reduce the amount of code, they may slow down your application.</p>